[gd_scene load_steps=8 format=3 uid="uid://c4o7qe5437oya"]

[ext_resource type="PackedScene" uid="uid://chaf5uqx5ltj2" path="res://scenes/objects/player/player.tscn" id="1_q1mjs"]
[ext_resource type="Script" path="res://scenes/map.gd" id="1_q7kco"]
[ext_resource type="Script" path="res://scenes/maps/heaven/dev/map_2/light_detection.gd" id="3_cqbpp"]
[ext_resource type="Script" path="res://addons/debug_tools/info_label/info_label.gd" id="4_ipbgo"]
[ext_resource type="Material" uid="uid://vxeny6igo7w5" path="res://textures/prototype_material.tres" id="5_rwyit"]

[sub_resource type="GDScript" id="GDScript_fvbla"]
script/source = "extends OmniLight3D




# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta):
	if Input.is_action_just_pressed('jump'):
		visible = !visible
"

[sub_resource type="Environment" id="Environment_02f0l"]
ambient_light_source = 2
glow_enabled = true
glow_normalized = true
fog_light_color = Color(0.262745, 0.286275, 0.32549, 1)
adjustment_enabled = true
adjustment_contrast = 1.17

[node name="World" type="Node3D"]
script = ExtResource("1_q7kco")

[node name="Player" parent="." instance=ExtResource("1_q1mjs")]

[node name="OmniLight3D" type="OmniLight3D" parent="Player"]
visible = false
layers = 0
light_color = Color(0.235294, 1, 0.917647, 1)
light_bake_mode = 0
script = SubResource("GDScript_fvbla")

[node name="ColorRect" type="ColorRect" parent="Player"]
custom_minimum_size = Vector2(10, 10)
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -36.0
offset_top = -26.0
grow_horizontal = 0
grow_vertical = 0

[node name="SubViewport" type="SubViewport" parent="Player"]
debug_draw = 2
size = Vector2i(64, 64)
render_target_update_mode = 4

[node name="LightDetection" type="Node3D" parent="Player/SubViewport" node_paths=PackedStringArray("player", "player_camera", "sub_viewport", "avg_color_debug", "player_light")]
script = ExtResource("3_cqbpp")
player = NodePath("../..")
player_camera = NodePath("../../Head/Camera3D")
sub_viewport = NodePath("..")
avg_color_debug = NodePath("../../ColorRect")
dark_threshold = 0.09
player_light = NodePath("../../OmniLight3D")

[node name="Camera3D" type="Camera3D" parent="Player/SubViewport/LightDetection"]
cull_mask = 524285
fov = 85.0

[node name="InfoLabel" type="Label" parent="Player"]
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -166.0
offset_top = -70.0
offset_right = -47.0
offset_bottom = -44.0
grow_horizontal = 0
grow_vertical = 0
theme_override_font_sizes/font_size = 24
text = "debug_is_dark: "
script = ExtResource("4_ipbgo")
target_path = NodePath("../SubViewport/LightDetection")
desired_property = "debug_is_dark"

[node name="InfoLabel2" type="Label" parent="Player"]
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -228.0
offset_top = -119.0
offset_right = -99.0
offset_bottom = -82.0
grow_horizontal = 0
grow_vertical = 0
theme_override_font_sizes/font_size = 24
text = "light_level: "
script = ExtResource("4_ipbgo")
target_path = NodePath("../SubViewport/LightDetection")
desired_property = "light_level"

[node name="CSGBox3D" type="CSGBox3D" parent="."]
use_collision = true
size = Vector3(41.3825, 4, 4)
material = ExtResource("5_rwyit")

[node name="CSGBox3D2" type="CSGBox3D" parent="CSGBox3D"]
operation = 2
size = Vector3(3.6, 3.6, 3.6)
material = ExtResource("5_rwyit")

[node name="CSGBox3D3" type="CSGBox3D" parent="CSGBox3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.711859, -0.445015, -1.63313)
operation = 2
size = Vector3(1.29335, 2.53876, 1.83235)
material = ExtResource("5_rwyit")

[node name="CSGBox3D3" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -7.98786)
use_collision = true
size = Vector3(41.3825, 4, 4)
material = ExtResource("5_rwyit")

[node name="CSGBox3D2" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.86832, -3.99358)
use_collision = true
size = Vector3(41.1825, 0.191538, 4)
material = ExtResource("5_rwyit")

[node name="CSGBox3D4" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.86367, -3.99358)
use_collision = true
size = Vector3(41.1825, 0.191538, 4)
material = ExtResource("5_rwyit")

[node name="CSGBox3D5" type="CSGBox3D" parent="."]
transform = Transform3D(-4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0, 0, 1, 20.4712, 0.174354, -3.99358)
use_collision = true
size = Vector3(4.55523, 0.191538, 4)
material = ExtResource("5_rwyit")

[node name="CSGBox3D6" type="CSGBox3D" parent="."]
transform = Transform3D(-4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0, 0, 1, -20.3972, 0.174354, -3.99358)
use_collision = true
size = Vector3(4.55523, 0.191538, 4)
material = ExtResource("5_rwyit")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_02f0l")

[node name="OmniLight3D" type="OmniLight3D" parent="."]
shadow_enabled = true
distance_fade_enabled = true
omni_range = 3.02078

[node name="OmniLight3D2" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7.62131, 0, -4.58921)
layers = 2
light_energy = 1.162
light_indirect_energy = 0.0
light_volumetric_fog_energy = 0.0
light_specular = 0.0
light_bake_mode = 0
shadow_enabled = true
distance_fade_enabled = true
omni_range = 3.9738

[editable path="Player"]
